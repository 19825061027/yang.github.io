#+INCLUDE: "../../prefix.org"

#+TITLE: /sys/bus/event_source 目录下devices/有内容, drivers/没有驱动

严格来说,perf框架对pmu的处理是这样的:
   1. 注册pmu实例到pmus,并有pmu--type--dev,一一对应,type被传到userspace
   2. 用户空间会将eventid和type同时传给内核
   3. 内核根据type找到pmu,再根据eventid得知目标pmu的目标事件号
      
因此,针对自perf_pmu_register之后的内容来说,只需要dev就可,并且这个dev还是由perf_pmu_register生成;
而arm-cmn.c 中需要driver,是因为cmn,pmu作为uncore设备,可能有也可能没有,因此需要走设备,总线,驱动框架,完成match.
因此,cpu pmu,只有一个dev是pmu->dev,代表pmu硬件
cmn pmu,有pmu->dev, platform_device, platform_driver, 后两者走platform_bus_type,完成match,并调用driver的probe,完成perf_pmu_register,之后既是pmu->dev的初始化device_initialize和添加设备device_add;
